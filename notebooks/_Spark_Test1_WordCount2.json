{"paragraphs":[{"text":"import org.apache.spark.sql.functions._\nval fulltext = spark.read.text(\"spark/divina_commedia.txt\")\nval words = fulltext\n    .select(lower(regexp_replace($\"value\", raw\"[^\\w]+\", \" \")).as(\"line\"))\n    .select(explode(split($\"line\",\" \")).as(\"word\"))\n    .where(\"word != ''\")\nwords.show()\n","user":"anonymous","dateUpdated":"2019-02-27T08:50:46-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|    word|\n+--------+\n| inferno|\n| inferno|\n|   canto|\n|       i|\n|     nel|\n|   mezzo|\n|     del|\n|  cammin|\n|      di|\n|  nostra|\n|    vita|\n|      mi|\n|ritrovai|\n|     per|\n|     una|\n|   selva|\n|  oscura|\n|     che|\n|      la|\n| diritta|\n+--------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.functions._\nfulltext: org.apache.spark.sql.DataFrame = [value: string]\nwords: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [word: string]\n"}]},"apps":[],"jobName":"paragraph_1551282401046_-1590799657","id":"20190227-074641_1705896738","dateCreated":"2019-02-27T07:46:41-0800","dateStarted":"2019-02-27T08:50:46-0800","dateFinished":"2019-02-27T08:50:46-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12759"},{"text":"words.where(\"length(word)>10\").groupBy(\"word\").count().orderBy(desc(\"count\")).show()","user":"anonymous","dateUpdated":"2019-02-27T07:50:02-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+\n|         word|count|\n+-------------+-----+\n|  maravigliar|   10|\n|  incominciai|    8|\n|  riguardando|    8|\n|etternalmente|    6|\n|  subitamente|    6|\n|  fiammeggiar|    4|\n|  simigliante|    4|\n|  sicuramente|    4|\n|  Barbariccia|    4|\n|  Malebranche|    4|\n|  liberamente|    4|\n| diversamente|    4|\n| misericordia|    4|\n| intelligenza|    4|\n| mirabilmente|    3|\n|  discendemmo|    3|\n|  similemente|    3|\n|  riguardommi|    3|\n|circunferenza|    3|\n|  somigliante|    3|\n+-------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551282533550_400734897","id":"20190227-074853_1173871758","dateCreated":"2019-02-27T07:48:53-0800","dateStarted":"2019-02-27T07:50:02-0800","dateFinished":"2019-02-27T07:50:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12760"},{"text":"val rdd = words.rdd.map(_.getString(0))","user":"anonymous","dateUpdated":"2019-02-27T07:51:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rdd: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[358] at map at <console>:85\n"}]},"apps":[],"jobName":"paragraph_1551282570548_-1777869817","id":"20190227-074930_1769405648","dateCreated":"2019-02-27T07:49:30-0800","dateStarted":"2019-02-27T07:51:12-0800","dateFinished":"2019-02-27T07:51:13-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12761"},{"text":"rdd.map(_.length).take(10)","user":"anonymous","dateUpdated":"2019-02-27T07:51:38-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res123: Array[Int] = Array(7, 7, 5, 1, 3, 5, 3, 6, 2, 6)\n"}]},"apps":[],"jobName":"paragraph_1551282648264_754012601","id":"20190227-075048_228251389","dateCreated":"2019-02-27T07:50:48-0800","dateStarted":"2019-02-27T07:51:38-0800","dateFinished":"2019-02-27T07:51:39-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12762"},{"text":"rdd.filter(s=>s.length>10).take(10)","user":"anonymous","dateUpdated":"2019-02-27T07:52:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res124: Array[String] = Array(apparecchiava, corruttibile, sensibilmente, cominciommi, comandamento, brievemente, misericordia, riconosciuto, Incontanente, Bestemmiavano)\n"}]},"apps":[],"jobName":"paragraph_1551282690461_117785953","id":"20190227-075130_214786165","dateCreated":"2019-02-27T07:51:30-0800","dateStarted":"2019-02-27T07:52:12-0800","dateFinished":"2019-02-27T07:52:12-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12763"},{"text":"def pippo(a:String, b:String):String = { if(a.length > b.length) return a else return b }\nrdd.reduce(pippo)","user":"anonymous","dateUpdated":"2019-02-27T08:25:06-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pippo: (a: String, b: String)String\nres127: String = perpetualemente\n"}]},"apps":[],"jobName":"paragraph_1551282732505_1035186353","id":"20190227-075212_545185909","dateCreated":"2019-02-27T07:52:12-0800","dateStarted":"2019-02-27T08:25:06-0800","dateFinished":"2019-02-27T08:25:07-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12764"},{"text":"rdd.partitions.length\n","user":"anonymous","dateUpdated":"2019-02-27T08:34:16-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res128: Int = 1\n"}]},"apps":[],"jobName":"paragraph_1551284635626_342776841","id":"20190227-082355_1117447475","dateCreated":"2019-02-27T08:23:55-0800","dateStarted":"2019-02-27T08:34:16-0800","dateFinished":"2019-02-27T08:34:17-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12765"},{"text":"rdd.map(r=>(r.toLowerCase(), 1)).take(10)\n","user":"anonymous","dateUpdated":"2019-02-27T08:51:18-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res136: Array[(String, Int)] = Array((inferno,1), (inferno,1), (canto,1), (i,1), (nel,1), (mezzo,1), (del,1), (cammin,1), (di,1), (nostra,1))\n"}]},"apps":[],"jobName":"paragraph_1551285256691_1573403951","id":"20190227-083416_771124898","dateCreated":"2019-02-27T08:34:16-0800","dateStarted":"2019-02-27T08:51:18-0800","dateFinished":"2019-02-27T08:51:18-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12766"},{"text":"rdd.keyBy(r=>r.toSeq(0).toString()).take(10)","user":"anonymous","dateUpdated":"2019-02-27T08:53:03-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res138: Array[(String, String)] = Array((I,INFERNO), (I,Inferno), (C,Canto), (I,I), (N,Nel), (m,mezzo), (d,del), (c,cammin), (d,di), (n,nostra))\n"}]},"apps":[],"jobName":"paragraph_1551285272489_190236981","id":"20190227-083432_2110034651","dateCreated":"2019-02-27T08:34:32-0800","dateStarted":"2019-02-27T08:53:03-0800","dateFinished":"2019-02-27T08:53:03-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12767"},{"text":"val pairs = rdd.keyBy(r=>r.toSeq(0).toString())\npairs.take(10)\npairs.lookup(\"C\")","user":"anonymous","dateUpdated":"2019-02-27T08:58:17-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pairs: org.apache.spark.rdd.RDD[(String, String)] = MapPartitionsRDD[385] at keyBy at <console>:88\nres139: Seq[String] = WrappedArray(Canto, Cammilla, Canto, Cosi, Canto, Caccianli, Caron, Caron, Come, Cosi, Caron, Canto, Come, Cosi, Cosi, Cosi, Cola, Cesare, Cammilla, Corniglia, Canto, Cosi, Cleopatras, Caina, Che, Canto, Cerbero, Cerbero, Cerbero, Ciacco, Ciacco, Canto, Cosi, Come, Cariddi, Cosi, Colui, Cosi, Canto, Corda, Chi, Con, Chi, Cosi, Chiuser, Chi, Canto, Con, Cosi, Come, Che, Cerbero, Carnaro, Canto, Che, Com, Chi, Come, Cardinale, Canto, Cosi, Caorsa, Carro, Coro, Canto, Creti, Corri, Cosi, Chiron, Chiron, Chiron, Cosi, Chiron, Cicilia, Colui, Cosi, Corneto, Canto, Cecina, Corneto, Cred, Come, Cesare, Cade, Come, Chi, Canto, Caton, Capaneo, Creta, Ciascuna, Cocito, Canto, C..."}]},"apps":[],"jobName":"paragraph_1551286365690_151150347","id":"20190227-085245_1382076394","dateCreated":"2019-02-27T08:52:45-0800","dateStarted":"2019-02-27T08:58:17-0800","dateFinished":"2019-02-27T08:58:18-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12768"},{"text":"pairs.countByKey()(\"E\")","user":"anonymous","dateUpdated":"2019-02-27T08:59:59-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res143: Long = 587\n"}]},"apps":[],"jobName":"paragraph_1551286697034_-135027640","id":"20190227-085817_1455466823","dateCreated":"2019-02-27T08:58:17-0800","dateStarted":"2019-02-27T08:59:59-0800","dateFinished":"2019-02-27T09:00:00-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12769"},{"text":"words.show()","user":"anonymous","dateUpdated":"2019-02-27T09:06:04-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|    word|\n+--------+\n| inferno|\n| inferno|\n|   canto|\n|       i|\n|     nel|\n|   mezzo|\n|     del|\n|  cammin|\n|      di|\n|  nostra|\n|    vita|\n|      mi|\n|ritrovai|\n|     per|\n|     una|\n|   selva|\n|  oscura|\n|     che|\n|      la|\n| diritta|\n+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551286757523_-1055028919","id":"20190227-085917_956905597","dateCreated":"2019-02-27T08:59:17-0800","dateStarted":"2019-02-27T09:06:04-0800","dateFinished":"2019-02-27T09:06:05-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12770"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551287103947_288301209","id":"20190227-090503_1659079807","dateCreated":"2019-02-27T09:05:03-0800","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12771"}],"name":"/Spark/Test1/WordCount2","id":"2E3XHKCCH","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}