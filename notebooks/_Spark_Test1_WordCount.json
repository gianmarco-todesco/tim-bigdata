{"paragraphs":[{"text":"val txt = spark.read.text(\"spark/divina_commedia.txt\")","user":"anonymous","dateUpdated":"2019-02-27T07:43:52-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"txt: org.apache.spark.sql.DataFrame = [value: string]\n"}]},"apps":[],"jobName":"paragraph_1551271015644_-550898246","id":"20190227-043655_1908912640","dateCreated":"2019-02-27T04:36:55-0800","dateStarted":"2019-02-27T07:43:52-0800","dateFinished":"2019-02-27T07:43:52-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10659"},{"text":"txt.count()","user":"anonymous","dateUpdated":"2019-02-27T04:47:57-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res9: Long = 19551\n"}]},"apps":[],"jobName":"paragraph_1551271373535_1585141493","id":"20190227-044253_1627860856","dateCreated":"2019-02-27T04:42:53-0800","dateStarted":"2019-02-27T04:47:57-0800","dateFinished":"2019-02-27T04:47:59-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10660"},{"text":"txt\n    .explode(\"value\", \"word\")((x:String)=>x.split(\" \"))\n    .where(\"length(word)>10\")\n    .groupBy(\"word\")\n    .count()\n    .orderBy(desc(\"count\"))\n    .show()\n","user":"anonymous","dateUpdated":"2019-02-27T05:05:03-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+-------------+-----+\n|         word|count|\n+-------------+-----+\n|  Purgatorio:|   33|\n|  maravigliar|    7|\n|  subitamente|    6|\n|  riguardando|    6|\n| incominciai:|    5|\n|  l'emisperio|    5|\n|  l'orizzonte|    5|\n|  ricomincio`|    5|\n|etternalmente|    5|\n| ricomincio`:|    5|\n|  maraviglia,|    5|\n|  provedenza,|    4|\n|  lagrimando,|    4|\n| incomincio`:|    4|\n|  fiammeggiar|    4|\n|  quell'altro|    4|\n| l'intelletto|    4|\n|  discendemmo|    3|\n| misericordia|    3|\n|  appressando|    3|\n+-------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551271677949_-101051734","id":"20190227-044757_1325749090","dateCreated":"2019-02-27T04:47:57-0800","dateStarted":"2019-02-27T05:05:03-0800","dateFinished":"2019-02-27T05:05:06-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10661"},{"text":"txt.as[String].map(s=>s.split(\" \")).show()","user":"anonymous","dateUpdated":"2019-02-27T05:10:06-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|               value|\n+--------------------+\n|                  []|\n|                  []|\n|           [INFERNO]|\n|                  []|\n|                  []|\n|                  []|\n|[Inferno:, Canto, I]|\n|                  []|\n|                  []|\n|[Nel, mezzo, del,...|\n|[, , mi, ritrovai...|\n|[, , che', la, di...|\n|                  []|\n|[Ahi, quanto, a, ...|\n|[, , esta, selva,...|\n|[, , che, nel, pe...|\n|                  []|\n|[Tant'e`, amara, ...|\n|[, , ma, per, tra...|\n|[, , diro`, de, l...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551272279406_-690947416","id":"20190227-045759_442484769","dateCreated":"2019-02-27T04:57:59-0800","dateStarted":"2019-02-27T05:10:06-0800","dateFinished":"2019-02-27T05:10:07-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10662"},{"text":"import org.apache.spark.sql.functions._\ntxt\n    .select(regexp_replace($\"value\", raw\"[^\\w]+\", \" \").as(\"line\"))\n    .explode(\"line\",\"word\")((s:String)=>s.split(\" \"))\n    .where(\"word != ''\")\n    .withColumn(\"tiodio\", regexp_extract($\"word\", raw\"[^\\w]+\", 0))\n    .filter(\"tiodio != ''\")\n    .show()\n","user":"anonymous","dateUpdated":"2019-02-27T05:58:55-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+----+----+------+\n|line|word|tiodio|\n+----+----+------+\n+----+----+------+\n\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1551272863011_1859536164","id":"20190227-050743_1648651840","dateCreated":"2019-02-27T05:07:43-0800","dateStarted":"2019-02-27T05:58:55-0800","dateFinished":"2019-02-27T05:58:56-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10663"},{"text":"import org.apache.spark.sql.functions._\ntxt\n    .select(lower(regexp_replace($\"value\", raw\"[^\\w]+\", \" \")).as(\"line\"))\n    .explode(\"line\",\"word\")((s:String)=>s.split(\" \"))\n    .where(\"word != ''\")\n    .where(\"length(word) >= 10\")\n    .groupBy(\"word\")\n    .count()\n    .orderBy(desc(\"count\"))\n    .show()","user":"anonymous","dateUpdated":"2019-02-27T06:03:17-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+-------------+-----+\n|         word|count|\n+-------------+-----+\n|   purgatorio|   35|\n|   maraviglia|   21|\n|   intelletto|   18|\n|   altrimenti|   16|\n|   quantunque|   14|\n|   ricomincio|   11|\n|  maravigliar|   10|\n|   esperienza|   10|\n|   igualmente|    9|\n|  incominciai|    8|\n|   incomincio|    8|\n|   provedenza|    8|\n|  riguardando|    8|\n|   ascoltando|    7|\n|   conoscenza|    7|\n|   lagrimando|    7|\n|  subitamente|    7|\n|   allegrezza|    6|\n|etternalmente|    6|\n|   testimonio|    5|\n+-------------+-----+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1551275547817_321946217","id":"20190227-055227_1851582948","dateCreated":"2019-02-27T05:52:27-0800","dateStarted":"2019-02-27T06:03:17-0800","dateFinished":"2019-02-27T06:03:19-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10664"},{"text":"import org.apache.spark.sql.functions._\ntxt\n    .select(lower(regexp_replace($\"value\", raw\"[^\\w]+\", \" \")).as(\"line\"))\n    .select(explode(split($\"line\",\" \")).as(\"word\"))\n    .show()","user":"anonymous","dateUpdated":"2019-02-27T06:11:44-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n|   word|\n+-------+\n|       |\n|       |\n|inferno|\n|       |\n|       |\n|       |\n|inferno|\n|  canto|\n|      i|\n|       |\n|       |\n|    nel|\n|  mezzo|\n|    del|\n| cammin|\n|     di|\n| nostra|\n|   vita|\n|       |\n|     mi|\n+-------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1551275954789_-1563355304","id":"20190227-055914_14759328","dateCreated":"2019-02-27T05:59:14-0800","dateStarted":"2019-02-27T06:11:44-0800","dateFinished":"2019-02-27T06:11:45-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10665"},{"text":"val lines = txt.select(lower(regexp_replace($\"value\", raw\"[^\\w]+\", \" \")).as(\"line\")).filter(\"line != ''\")\nlines.show()","user":"anonymous","dateUpdated":"2019-02-27T07:44:23-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                line|\n+--------------------+\n|             inferno|\n|     inferno canto i|\n|nel mezzo del cam...|\n| mi ritrovai per ...|\n| che la diritta v...|\n|ahi quanto a dir ...|\n| esta selva selva...|\n| che nel pensier ...|\n|tant e amara che ...|\n| ma per trattar d...|\n| diro de l altre ...|\n|io non so ben rid...|\n| tant era pien di...|\n| che la verace vi...|\n|ma poi ch i fui a...|\n| la dove terminav...|\n| che m avea di pa...|\n|guardai in alto e...|\n| vestite gia de r...|\n| che mena dritto ...|\n+--------------------+\nonly showing top 20 rows\n\nlines: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [line: string]\n"}]},"apps":[],"jobName":"paragraph_1551276422993_-399195695","id":"20190227-060702_984360010","dateCreated":"2019-02-27T06:07:02-0800","dateStarted":"2019-02-27T07:44:23-0800","dateFinished":"2019-02-27T07:44:24-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10666"},{"text":"lines.explode(\"line\",\"word\")((s:String)=>s.split(\" \")).show()","user":"anonymous","dateUpdated":"2019-02-27T06:13:45-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+--------------------+--------+\n|                line|    word|\n+--------------------+--------+\n|             inferno| inferno|\n|     inferno canto i| inferno|\n|     inferno canto i|   canto|\n|     inferno canto i|       i|\n|nel mezzo del cam...|     nel|\n|nel mezzo del cam...|   mezzo|\n|nel mezzo del cam...|     del|\n|nel mezzo del cam...|  cammin|\n|nel mezzo del cam...|      di|\n|nel mezzo del cam...|  nostra|\n|nel mezzo del cam...|    vita|\n| mi ritrovai per ...|        |\n| mi ritrovai per ...|      mi|\n| mi ritrovai per ...|ritrovai|\n| mi ritrovai per ...|     per|\n| mi ritrovai per ...|     una|\n| mi ritrovai per ...|   selva|\n| mi ritrovai per ...|  oscura|\n| che la diritta v...|        |\n| che la diritta v...|     che|\n+--------------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551276733050_240215690","id":"20190227-061213_1515966471","dateCreated":"2019-02-27T06:12:13-0800","dateStarted":"2019-02-27T06:13:45-0800","dateFinished":"2019-02-27T06:13:45-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10667"},{"text":"spark.sparkContext\n","user":"anonymous","dateUpdated":"2019-02-27T06:30:29-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res82: org.apache.spark.SparkContext = org.apache.spark.SparkContext@59dfdc43\n"}]},"apps":[],"jobName":"paragraph_1551276818035_1340041510","id":"20190227-061338_1672068561","dateCreated":"2019-02-27T06:13:38-0800","dateStarted":"2019-02-27T06:30:29-0800","dateFinished":"2019-02-27T06:30:30-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10668"},{"text":"val rdd = lines.toDF().as[String].rdd\n","user":"anonymous","dateUpdated":"2019-02-27T06:40:49-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rdd: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[257] at rdd at <console>:82\n"}]},"apps":[],"jobName":"paragraph_1551277829598_-1956420897","id":"20190227-063029_74994605","dateCreated":"2019-02-27T06:30:29-0800","dateStarted":"2019-02-27T06:40:49-0800","dateFinished":"2019-02-27T06:40:49-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10669"},{"text":"rdd.toDF()","user":"anonymous","dateUpdated":"2019-02-27T06:40:58-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res89: org.apache.spark.sql.DataFrame = [value: string]\n"}]},"apps":[],"jobName":"paragraph_1551278376110_-741933352","id":"20190227-063936_571524644","dateCreated":"2019-02-27T06:39:36-0800","dateStarted":"2019-02-27T06:40:58-0800","dateFinished":"2019-02-27T06:40:58-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10670"},{"text":"spark.createDataset(rdd).show()","user":"anonymous","dateUpdated":"2019-02-27T06:43:22-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|               value|\n+--------------------+\n|             inferno|\n|     inferno canto i|\n|nel mezzo del cam...|\n| mi ritrovai per ...|\n| che la diritta v...|\n|ahi quanto a dir ...|\n| esta selva selva...|\n| che nel pensier ...|\n|tant e amara che ...|\n| ma per trattar d...|\n| diro de l altre ...|\n|io non so ben rid...|\n| tant era pien di...|\n| che la verace vi...|\n|ma poi ch i fui a...|\n| la dove terminav...|\n| che m avea di pa...|\n|guardai in alto e...|\n| vestite gia de r...|\n| che mena dritto ...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551278458456_-980909419","id":"20190227-064058_1128043639","dateCreated":"2019-02-27T06:40:58-0800","dateStarted":"2019-02-27T06:43:22-0800","dateFinished":"2019-02-27T06:43:23-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10671"},{"text":"","user":"anonymous","dateUpdated":"2019-02-27T07:00:07-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res93: org.apache.spark.sql.DataFrame = [line: string]\n"}]},"apps":[],"jobName":"paragraph_1551278589343_-1193468824","id":"20190227-064309_606529023","dateCreated":"2019-02-27T06:43:09-0800","dateStarted":"2019-02-27T06:59:53-0800","dateFinished":"2019-02-27T06:59:53-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10672"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551279586068_-3176888","id":"20190227-065946_1192096042","dateCreated":"2019-02-27T06:59:46-0800","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:10673"}],"name":"/Spark/Test1/WordCount","id":"2E538PR7A","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}